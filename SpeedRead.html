<!DOCTYPE html>
<html>
<head>

	<title>Speed Reader</title>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	
	<style>
	
	</style>
		
		
		
	
</head>
<body>

<h1 id="out" class="jumbotron text-center"></h1>



<button id="start"><span class="fa fa-play"></span></button>
<button id="pause"><span class="fa fa-pause"></span></button>
<button id="stop"><span class="fa fa-stop"></span></button>

<br>

<textarea id="input">Four score and seven years ago, </textarea>

<script>

	//Data Object for app
	let d = {	
	mSec: 280,
	next: 0,
	inpt: [],
	stop: 1,
	time: 0,
	time2: 0,
	reset: function(){
		d.mSec = 280;
		d.next = 0;
		d.inpt = [];
		d.stop = 1;
		d.time = 0;
		d.time2 = 0;
		initVars();
	},
	duration: function(){
		var a = (d.time2.getTime() - d.time.getTime() ) / 100;
		var b = parseInt(a)/10;
		var min = parseInt(b/60);
		var cln = ":";
		if (parseInt(b) < 10){
			cln += "0";
		} 

		return min + cln + ( b % 60);
	}
	}

	function initVars(){

		//put words into an array.
		let inpt1 = $("#input").val();
		d.inpt = inpt1.split(" ");
		d.inpt.push(" ");         //<= Ensure the last word does not show when done.
		d.len = d.inpt.length;
		
	}

	function nextWord(){

		//Get start time in milliseconds, if this is not a recursive call
		if (d.time === 0){
			d.time = new Date();
		}
		
		setTimeout(function(){
			if ( d.next < d.len && d.stop > 0 ){
				d.next++;
				$("#out").text( d.inpt[d.next - 1] );
				
			} else {
				
				//Get time of end, in milliseconds
				d.time2 = new Date();
				$("#out").text( "Time to read: " +  d.duration() );
				
				d.reset(); //<= clears state of d Object
				return;
			}
			nextWord();
		}, d.mSec);
	};
	
	//Initalize variables
	initVars();
	
	$("#start").click(function(){ nextWord()  });
	$("#input").change(function(){ initVars() });
	$("#stop").click(function(){ d.stop *= -1; });
	
	
</script>

</body>
</html>